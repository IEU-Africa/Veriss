<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organization Dashboard - Veriss Payments</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <link rel="stylesheet" href="assets/css/app.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="assets/js/auth.js"></script>
    <script src="assets/js/org.js"></script>
  </head>

  <body class="bg-neutral-50">
    <div id="app" class="min-h-screen">
      <header class="modern-header">
        <div class="modern-container flex justify-between items-center">
          <h1 class="text-2xl font-bold text-white flex items-center gap-2">
            <i data-lucide="building-2" class="w-6 h-6"></i>
            Organization Dashboard
          </h1>
          <div class="flex items-center gap-4">
            <span class="text-white/90 font-medium">Welcome, {{ currentUser.name }}</span>
            <button @click="logout" class="btn btn-outline text-white border-white hover:bg-white/10">
              <i data-lucide="log-out" class="w-4 h-4"></i>
              Logout
            </button>
          </div>
        </div>
      </header>

      <main class="modern-container py-8">
        <div class="modern-grid modern-grid-3 mb-8">
          <div class="stat-card">
            <div class="flex items-center justify-between mb-2">
              <h3 class="text-sm font-medium text-neutral-600 uppercase tracking-wide">Total Members</h3>
              <i data-lucide="users" class="w-5 h-5 text-primary-600"></i>
            </div>
            <p class="stat-value text-primary-600">{{ organization?.members?.length || 0 }}</p>
          </div>
          <div class="stat-card">
            <div class="flex items-center justify-between mb-2">
              <h3 class="text-sm font-medium text-neutral-600 uppercase tracking-wide">Active Dues</h3>
              <i data-lucide="file-text" class="w-5 h-5 text-success-600"></i>
            </div>
            <p class="stat-value text-success-600">{{ organization?.dues?.length || 0 }}</p>
          </div>
          <div class="stat-card">
            <div class="flex items-center justify-between mb-2">
              <h3 class="text-sm font-medium text-neutral-600 uppercase tracking-wide">Total Payments</h3>
              <i data-lucide="credit-card" class="w-5 h-5" style="color: #9333ea;"></i>
            </div>
            <p class="stat-value" style="color: #9333ea;">₦{{ (totalPayments || 0).toLocaleString() }}</p>
          </div>
        </div>

        <div class="modern-grid modern-grid-2">
          <div class="modern-card">
            <h3 class="text-xl font-semibold mb-6 flex items-center gap-2 text-neutral-900">
              <i data-lucide="zap" class="w-5 h-5 text-primary-600"></i>
              Quick Actions
            </h3>
            <div class="space-y-3">
              <a href="manage-payments.html" class="btn btn-primary w-full text-center py-3">
                <i data-lucide="settings" class="w-5 h-5"></i>
                Manage Payments
              </a>
              <button class="btn btn-success w-full text-center py-3">
                <i data-lucide="user-plus" class="w-5 h-5"></i>
                Add New Member
              </button>
              <button class="btn w-full text-center py-3" style="background: linear-gradient(135deg, #9333ea 0%, #7e22ce 100%); color: white;">
                <i data-lucide="file-text" class="w-5 h-5"></i>
                View Reports
              </button>
            </div>
          </div>

          <div class="modern-card">
            <h3 class="text-xl font-semibold mb-6 flex items-center gap-2 text-neutral-900">
              <i data-lucide="clock" class="w-5 h-5 text-primary-600"></i>
              Recent Activity
            </h3>
            <div class="space-y-4">
              <div v-for="due in organization?.dues?.slice(0, 3)" class="flex justify-between items-center p-3 rounded-lg hover:bg-neutral-50 transition-colors">
                <span class="font-medium text-neutral-900">{{ due.title }}</span>
                <span class="text-success-600 font-semibold">₦{{ due.amount?.toLocaleString() || 0 }}</span>
              </div>
              <div v-if="!organization?.dues || organization.dues.length === 0" class="text-center text-neutral-500 py-4">
                No recent activity
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script>
      const { createApp } = Vue;

      createApp({
        data() {
          return {
            currentUser: null,
            organization: null,
            totalPayments: 0
          }
        },
        mounted() {
          lucide.createIcons();
          this.currentUser = getCurrentUser();
          if (this.currentUser && this.currentUser.role === 'org') {
            this.organization = getOrganization(this.currentUser.orgId);
            this.calculateTotalPayments();
          } else {
            window.location.href = 'login.html';
          }
        },
        updated() {
          lucide.createIcons();
        },
        methods: {
          logout() {
            logout();
            window.location.href = 'index.html';
          },
          calculateTotalPayments() {
            if (this.organization && this.organization.dues) {
              this.totalPayments = this.organization.dues.reduce((sum, due) => sum + (due.amount || 0), 0);
            }
          }
        }
      }).mount('#app');
    </script>
  </body>

</html>